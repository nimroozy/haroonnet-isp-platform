#
# HaroonNet ISP Platform - RADIUS Clients Configuration
# Defines which devices can send RADIUS requests to this server
#

######################################################################
# Default client for testing
######################################################################
client localhost {
	ipaddr = 127.0.0.1
	secret = testing123
	require_message_authenticator = no
	nas_type = other
	shortname = localhost
}

client localhost_ipv6 {
	ipv6addr = ::1
	secret = testing123
	shortname = localhost
}

######################################################################
# Docker network clients
######################################################################
client docker-network {
	ipaddr = 172.0.0.0/8
	secret = testing123
	require_message_authenticator = no
	nas_type = other
	shortname = docker
}

######################################################################
# Mikrotik NAS Clients
# These are examples - actual clients should be added via database or
# configured here with proper IP addresses and secrets
######################################################################

# Main Mikrotik Router
client mikrotik-main {
	ipaddr = 192.168.1.1
	secret = haroonnet-secret-2024
	require_message_authenticator = no
	nas_type = mikrotik
	shortname = mt-main

	# CoA support
	coa_server = yes

	# Limits
	limit {
		max_connections = 16
		lifetime = 0
		idle_timeout = 30
	}
}

# Hotspot Gateway
client mikrotik-hotspot {
	ipaddr = 192.168.1.10
	secret = haroonnet-secret-2024
	require_message_authenticator = no
	nas_type = mikrotik
	shortname = mt-hotspot

	# CoA support for bandwidth changes
	coa_server = yes

	limit {
		max_connections = 16
		lifetime = 0
		idle_timeout = 30
	}
}

# Branch Office Router
client mikrotik-branch {
	ipaddr = 192.168.2.1
	secret = haroonnet-secret-2024
	require_message_authenticator = no
	nas_type = mikrotik
	shortname = mt-branch

	coa_server = yes

	limit {
		max_connections = 8
		lifetime = 0
		idle_timeout = 30
	}
}

######################################################################
# Network Ranges for Multiple NAS Devices
######################################################################

# Main office network
client main-office-network {
	ipaddr = 192.168.1.0/24
	secret = haroonnet-secret-2024
	require_message_authenticator = no
	nas_type = mikrotik
	shortname = main-office
	coa_server = yes
}

# Branch offices network
client branch-offices {
	ipaddr = 192.168.0.0/16
	secret = haroonnet-secret-2024
	require_message_authenticator = no
	nas_type = mikrotik
	shortname = branches
	coa_server = yes
}

# Public IP range (if using public IPs for NAS)
# client public-nas-range {
#     ipaddr = 203.0.113.0/24
#     secret = haroonnet-public-secret-2024
#     require_message_authenticator = yes
#     nas_type = mikrotik
#     shortname = public-nas
#     coa_server = yes
# }

######################################################################
# CoA Origination Clients
# These define which servers can send CoA requests TO this RADIUS server
######################################################################

client coa-api-server {
	ipaddr = 172.18.0.0/16  # Docker network for API server
	secret = haroonnet-coa-secret-2024
	require_message_authenticator = yes
	nas_type = other
	shortname = api-coa

	# This client can send CoA requests
	coa_server = yes
}

# Management server for CoA requests
client management-server {
	ipaddr = 192.168.1.100
	secret = haroonnet-coa-secret-2024
	require_message_authenticator = yes
	nas_type = other
	shortname = mgmt-coa
	coa_server = yes
}

######################################################################
# Per-client limits and timeouts
######################################################################

# High-traffic NAS with increased limits
client high-traffic-nas {
	ipaddr = 192.168.1.50
	secret = haroonnet-secret-2024
	require_message_authenticator = no
	nas_type = mikrotik
	shortname = ht-nas
	coa_server = yes

	limit {
		max_connections = 32
		lifetime = 86400
		idle_timeout = 60
	}
}

######################################################################
# Client Templates (for reference)
######################################################################

# Template for new Mikrotik devices:
# client new-mikrotik {
#     ipaddr = x.x.x.x
#     secret = haroonnet-secret-2024
#     require_message_authenticator = no
#     nas_type = mikrotik
#     shortname = descriptive-name
#     coa_server = yes
#
#     limit {
#         max_connections = 16
#         lifetime = 0
#         idle_timeout = 30
#     }
# }

######################################################################
# Security Notes:
# 1. Change all default secrets in production
# 2. Use strong, unique secrets for each NAS
# 3. Limit IP ranges to only necessary networks
# 4. Enable message authenticator for public networks
# 5. Monitor failed authentication attempts
######################################################################
